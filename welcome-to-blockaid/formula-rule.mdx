---
title: "Formula Detection Rule"
---

Formula Detection Rules let you create custom alerts using mathematical expressions that combine multiple blockchain metrics. Instead of regular detection rules that fire on singular events, you can build detection logic that monitor a metric crossing a threshold or detect complex logic on relationships between different data points.

Think of formula rules as smart calculators for your blockchain data. You can combine different metrics (like token balances and contract values) using mathematical operations to create powerful detection conditions.

**When the formula result i**`true`**, an incident is created with your chosen severity level.**

<Tip>
  **Why Use Formula Rules?**

  - **Complex Logic**: Combine multiple conditions with AND/OR operations
  - **Trend Detection**: Monitor how values change over time periods
  - **Relative Comparisons**: Compare metrics against each other, not just fixed thresholds
  - **Advanced Math**: Use calculations like ratios, percentages, and multipliers
</Tip>

import MySnippet from '/snippets/divider.mdx';

<MySnippet />

# Create a Formula Rule

To create a Formula Detection Rule, follow these steps:

<Accordion title="Step 1: Create a New Rule">
  ## Step 1: Create a New Rule

  1. On the Blockaid platform, navigate to **Detection Rules** and then click **Add Detection Rule**.

     \<Image align="center" src="https://files.readme.io/4b57c1a8dfad075c6a938226668c2febf8c58e5aee710215d93efb2b771fcafb-image.png" /\>

     The Add Custom Detection Rule window opens.
  2. From the **Choose Detection Logic** section, select the **Formula Rule** logic and click **Next**.
  3. Under the **Configure Rule** section, complete the fields as follows:
     - **Rule Name** - Enter a descriptive name that will help you easily identify the rule in the detection rules list.
     - **Tags** - Add tags that will allow you to organize your environment better.
     - **Incident Name** - Provide the name of the incident that will be created when the rule is met. This name will appear in the Incidents page.
     - **Category** - Determine under which category the incident will be placed when created.
</Accordion>

<Accordion title="Step 2: Define Metrics">
  A metric is the data point you want to monitor as part of your rule. Once the metric meets a pre-determined condition (set up in the Formula section), the rule will trigger and an Incident will be created. For instance, track the volume of a specific token in your wallet and trigger the rule when the volume exceeds 20%.

  Metrics are saved and can be reused across multiple formula rules. Saved metrics can also be edited and adjusted to fit changing needs.

  There are two types of metrics:

  - **Contract Call (EVM)** - Read a numeric value by calling a read-only smart contract function. Common for balances, supply, counters, configuration values.
  - **Read Object (Sui)** - Read a numeric value from a Sui object. This is useful for reading counters and balances stored as Sui object fields.

  <Warning>
    **Note**\
    The contract (for Contract Call type) or Sui object (for Object Read type) must already exist in your Inventory as an asset before you can configure and save the metric.
  </Warning>
  **To define metrics:**

  1. Click the **Choose Metric** dropdown and select an existing metric, or click **\+ Add new metric** to create a new one.

     <Tip>
       **Tip**

       If you're selecting an existing metric, skip to the Create Formula section.
     </Tip>
     2. Under the **Configure Metric**, fill in the following:
        1. **Metric Name** - Enter a descriptive name that will help you easily identify the metric in the metrics list.
        2. **Metric Type** - Select the type of metric (Contract Call or Read Object).
     3. Continue based on the selected type:

        <Tabs>
          <Tab title="Contract Call (EVM)">
            Fill-in the fields as follows:
            1. **Target** - Select the contract to read from. This list is based on your Inventory.
            2. **Function** - The function to call from the contract, e.g. `balanceOf(address)` or `totalSupply()`. This list will show only functions that return numeric values.
            3. **Input Parameters** - The arguments to pass to the function. Some functions don't require input parameters.
            4. **Output Field** - Which returned value to use. Only numeric outputs are selectable.

               <Warning>
                 **Note**

                 If the Functions list is empty, the contract you've selected doesn't include functions that return numeric values. To continue, select a different contract.
               </Warning>
          </Tab>
          <Tab title="Read Object (Sui)">
            Fill-in the fields as follows:
            1. **Target** - Select the Sui object to read from. This list is based on your Inventory.
            2. **Field** - The numeric field to extract. Only numeric fields are selectable.
          </Tab>
        </Tabs>
        4. Click **Test Metric** to validate the metric's configuration.
        5. Once the test passed successfully, click **Save Metric**.
        6. Check that your metrics are collecting data correctly and review their values.
</Accordion>